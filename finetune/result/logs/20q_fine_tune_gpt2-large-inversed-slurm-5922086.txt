/work/anshitagupta_umass_edu/miniconda3/envs/memit/lib/python3.9/site-packages/transformers/optimization.py:306: FutureWarning: This implementation of AdamW is deprecated and will be removed in a future version. Use the PyTorch implementation torch.optim.AdamW instead, or set `no_deprecation_warning=True` to disable this warning
  warnings.warn(
***** Running training *****
  Num examples = 2020
  Num Epochs = 5
  Instantaneous batch size per device = 32
  Total train batch size (w. parallel, distributed & accumulation) = 32
  Gradient Accumulation steps = 1
  Total optimization steps = 320
Loaded dataset with 2020 elements
Loaded dataset with 496 elements
  0%|          | 0/320 [00:00<?, ?it/s]  0%|          | 1/320 [00:01<07:39,  1.44s/it]  1%|          | 2/320 [00:02<06:36,  1.25s/it]  1%|          | 3/320 [00:03<06:14,  1.18s/it]  1%|▏         | 4/320 [00:04<06:03,  1.15s/it]  2%|▏         | 5/320 [00:05<05:56,  1.13s/it]  2%|▏         | 6/320 [00:06<05:51,  1.12s/it]  2%|▏         | 7/320 [00:08<05:49,  1.12s/it]  2%|▎         | 8/320 [00:09<05:46,  1.11s/it]  3%|▎         | 9/320 [00:10<05:44,  1.11s/it]  3%|▎         | 10/320 [00:11<05:42,  1.11s/it]  3%|▎         | 11/320 [00:12<05:41,  1.11s/it]  4%|▍         | 12/320 [00:13<05:40,  1.11s/it]  4%|▍         | 13/320 [00:14<05:39,  1.11s/it]  4%|▍         | 14/320 [00:15<05:37,  1.10s/it]  5%|▍         | 15/320 [00:16<05:36,  1.10s/it]  5%|▌         | 16/320 [00:17<05:35,  1.10s/it]  5%|▌         | 17/320 [00:19<05:34,  1.10s/it]  6%|▌         | 18/320 [00:20<05:33,  1.10s/it]  6%|▌         | 19/320 [00:21<05:31,  1.10s/it]  6%|▋         | 20/320 [00:22<05:31,  1.10s/it]  7%|▋         | 21/320 [00:23<05:30,  1.10s/it]  7%|▋         | 22/320 [00:24<05:28,  1.10s/it]  7%|▋         | 23/320 [00:25<05:27,  1.10s/it]  8%|▊         | 24/320 [00:26<05:26,  1.10s/it]  8%|▊         | 25/320 [00:27<05:25,  1.10s/it]  8%|▊         | 26/320 [00:29<05:24,  1.10s/it]  8%|▊         | 27/320 [00:30<05:23,  1.10s/it]  9%|▉         | 28/320 [00:31<05:21,  1.10s/it]  9%|▉         | 29/320 [00:32<05:20,  1.10s/it]  9%|▉         | 30/320 [00:33<05:19,  1.10s/it] 10%|▉         | 31/320 [00:34<05:18,  1.10s/it] 10%|█         | 32/320 [00:35<05:17,  1.10s/it] 10%|█         | 33/320 [00:36<05:16,  1.10s/it] 11%|█         | 34/320 [00:37<05:15,  1.10s/it] 11%|█         | 35/320 [00:38<05:13,  1.10s/it] 11%|█▏        | 36/320 [00:40<05:12,  1.10s/it] 12%|█▏        | 37/320 [00:41<05:11,  1.10s/it] 12%|█▏        | 38/320 [00:42<05:10,  1.10s/it] 12%|█▏        | 39/320 [00:43<05:09,  1.10s/it] 12%|█▎        | 40/320 [00:44<05:08,  1.10s/it] 13%|█▎        | 41/320 [00:45<05:07,  1.10s/it] 13%|█▎        | 42/320 [00:46<05:06,  1.10s/it] 13%|█▎        | 43/320 [00:47<05:05,  1.10s/it] 14%|█▍        | 44/320 [00:48<05:04,  1.10s/it] 14%|█▍        | 45/320 [00:49<05:03,  1.10s/it] 14%|█▍        | 46/320 [00:51<05:02,  1.10s/it] 15%|█▍        | 47/320 [00:52<05:01,  1.10s/it] 15%|█▌        | 48/320 [00:53<05:00,  1.10s/it] 15%|█▌        | 49/320 [00:54<04:58,  1.10s/it] 16%|█▌        | 50/320 [00:55<04:57,  1.10s/it] 16%|█▌        | 51/320 [00:56<04:56,  1.10s/it] 16%|█▋        | 52/320 [00:57<04:55,  1.10s/it] 17%|█▋        | 53/320 [00:58<04:54,  1.10s/it] 17%|█▋        | 54/320 [00:59<04:53,  1.10s/it] 17%|█▋        | 55/320 [01:00<04:52,  1.10s/it] 18%|█▊        | 56/320 [01:02<04:51,  1.10s/it] 18%|█▊        | 57/320 [01:03<04:50,  1.10s/it] 18%|█▊        | 58/320 [01:04<04:49,  1.10s/it] 18%|█▊        | 59/320 [01:05<04:48,  1.10s/it] 19%|█▉        | 60/320 [01:06<04:46,  1.10s/it] 19%|█▉        | 61/320 [01:07<04:45,  1.10s/it] 19%|█▉        | 62/320 [01:08<04:44,  1.10s/it] 20%|█▉        | 63/320 [01:09<04:43,  1.10s/it] 20%|██        | 64/320 [01:10<03:59,  1.07it/s]***** Running Evaluation *****
  Num examples = 496
  Batch size = 32

  0%|          | 0/16 [00:00<?, ?it/s][A
 12%|█▎        | 2/16 [00:00<00:01,  8.65it/s][A
 19%|█▉        | 3/16 [00:00<00:02,  6.09it/s][A
 25%|██▌       | 4/16 [00:00<00:02,  5.28it/s][A
 31%|███▏      | 5/16 [00:00<00:02,  4.90it/s][A
 38%|███▊      | 6/16 [00:01<00:02,  4.68it/s][A
 44%|████▍     | 7/16 [00:01<00:01,  4.56it/s][A
 50%|█████     | 8/16 [00:01<00:01,  4.48it/s][A
 56%|█████▋    | 9/16 [00:01<00:01,  4.43it/s][A
 62%|██████▎   | 10/16 [00:02<00:01,  4.39it/s][A
 69%|██████▉   | 11/16 [00:02<00:01,  4.37it/s][A
 75%|███████▌  | 12/16 [00:02<00:00,  4.35it/s][A
 81%|████████▏ | 13/16 [00:02<00:00,  4.34it/s][A
 88%|████████▊ | 14/16 [00:03<00:00,  4.33it/s][A
 94%|█████████▍| 15/16 [00:03<00:00,  4.32it/s][A
100%|██████████| 16/16 [00:03<00:00,  4.90it/s][A                                                
                                               [A 20%|██        | 64/320 [01:13<03:59,  1.07it/s]
100%|██████████| 16/16 [00:03<00:00,  4.90it/s][A
                                               [ASaving model checkpoint to results/checkpoint-64
Configuration saved in results/checkpoint-64/config.json
Model weights saved in results/checkpoint-64/pytorch_model.bin
 20%|██        | 65/320 [03:59<3:38:21, 51.38s/it] 21%|██        | 66/320 [04:00<2:33:38, 36.30s/it] 21%|██        | 67/320 [04:01<1:48:31, 25.74s/it] 21%|██▏       | 68/320 [04:02<1:17:03, 18.35s/it] 22%|██▏       | 69/320 [04:03<55:06, 13.17s/it]   22%|██▏       | 70/320 [04:04<39:47,  9.55s/it] 22%|██▏       | 71/320 [04:06<29:07,  7.02s/it] 22%|██▎       | 72/320 [04:07<21:39,  5.24s/it] 23%|██▎       | 73/320 [04:08<16:27,  4.00s/it] 23%|██▎       | 74/320 [04:09<12:50,  3.13s/it] 23%|██▎       | 75/320 [04:10<10:18,  2.52s/it] 24%|██▍       | 76/320 [04:11<08:31,  2.10s/it] 24%|██▍       | 77/320 [04:12<07:16,  1.80s/it] 24%|██▍       | 78/320 [04:13<06:24,  1.59s/it] 25%|██▍       | 79/320 [04:14<05:48,  1.44s/it] 25%|██▌       | 80/320 [04:15<05:21,  1.34s/it] 25%|██▌       | 81/320 [04:17<05:03,  1.27s/it] 26%|██▌       | 82/320 [04:18<04:50,  1.22s/it] 26%|██▌       | 83/320 [04:19<04:40,  1.19s/it] 26%|██▋       | 84/320 [04:20<04:33,  1.16s/it] 27%|██▋       | 85/320 [04:21<04:28,  1.14s/it] 27%|██▋       | 86/320 [04:22<04:24,  1.13s/it] 27%|██▋       | 87/320 [04:23<04:21,  1.12s/it] 28%|██▊       | 88/320 [04:24<04:19,  1.12s/it] 28%|██▊       | 89/320 [04:25<04:17,  1.11s/it] 28%|██▊       | 90/320 [04:27<04:15,  1.11s/it] 28%|██▊       | 91/320 [04:28<04:13,  1.11s/it] 29%|██▉       | 92/320 [04:29<04:12,  1.11s/it] 29%|██▉       | 93/320 [04:30<04:11,  1.11s/it] 29%|██▉       | 94/320 [04:31<04:10,  1.11s/it] 30%|██▉       | 95/320 [04:32<04:08,  1.11s/it] 30%|███       | 96/320 [04:33<04:07,  1.10s/it] 30%|███       | 97/320 [04:34<04:06,  1.11s/it] 31%|███       | 98/320 [04:35<04:05,  1.11s/it] 31%|███       | 99/320 [04:36<04:04,  1.11s/it] 31%|███▏      | 100/320 [04:38<04:03,  1.10s/it] 32%|███▏      | 101/320 [04:39<04:01,  1.10s/it] 32%|███▏      | 102/320 [04:40<04:00,  1.10s/it] 32%|███▏      | 103/320 [04:41<03:59,  1.10s/it] 32%|███▎      | 104/320 [04:42<03:58,  1.10s/it] 33%|███▎      | 105/320 [04:43<03:57,  1.10s/it] 33%|███▎      | 106/320 [04:44<03:55,  1.10s/it] 33%|███▎      | 107/320 [04:45<03:55,  1.10s/it] 34%|███▍      | 108/320 [04:46<03:53,  1.10s/it] 34%|███▍      | 109/320 [04:47<03:52,  1.10s/it] 34%|███▍      | 110/320 [04:49<03:51,  1.10s/it] 35%|███▍      | 111/320 [04:50<03:50,  1.10s/it] 35%|███▌      | 112/320 [04:51<03:49,  1.10s/it] 35%|███▌      | 113/320 [04:52<03:48,  1.10s/it] 36%|███▌      | 114/320 [04:53<03:47,  1.10s/it] 36%|███▌      | 115/320 [04:54<03:46,  1.10s/it] 36%|███▋      | 116/320 [04:55<03:45,  1.10s/it] 37%|███▋      | 117/320 [04:56<03:43,  1.10s/it] 37%|███▋      | 118/320 [04:57<03:42,  1.10s/it] 37%|███▋      | 119/320 [04:59<03:41,  1.10s/it] 38%|███▊      | 120/320 [05:00<03:41,  1.11s/it] 38%|███▊      | 121/320 [05:01<03:39,  1.10s/it] 38%|███▊      | 122/320 [05:02<03:38,  1.10s/it] 38%|███▊      | 123/320 [05:03<03:37,  1.10s/it] 39%|███▉      | 124/320 [05:04<03:36,  1.10s/it] 39%|███▉      | 125/320 [05:05<03:35,  1.11s/it] 39%|███▉      | 126/320 [05:06<03:34,  1.11s/it] 40%|███▉      | 127/320 [05:07<03:33,  1.11s/it] 40%|████      | 128/320 [05:08<02:59,  1.07it/s]***** Running Evaluation *****
  Num examples = 496
  Batch size = 32
{'eval_loss': 1.0494050979614258, 'eval_runtime': 3.6204, 'eval_samples_per_second': 137.001, 'eval_steps_per_second': 4.419, 'epoch': 1.0}

  0%|          | 0/16 [00:00<?, ?it/s][A
 12%|█▎        | 2/16 [00:00<00:01,  8.64it/s][A
 19%|█▉        | 3/16 [00:00<00:02,  6.09it/s][A
 25%|██▌       | 4/16 [00:00<00:02,  5.28it/s][A
 31%|███▏      | 5/16 [00:00<00:02,  4.89it/s][A
 38%|███▊      | 6/16 [00:01<00:02,  4.68it/s][A
 44%|████▍     | 7/16 [00:01<00:01,  4.56it/s][A
 50%|█████     | 8/16 [00:01<00:01,  4.48it/s][A
 56%|█████▋    | 9/16 [00:01<00:01,  4.42it/s][A
 62%|██████▎   | 10/16 [00:02<00:01,  4.39it/s][A
 69%|██████▉   | 11/16 [00:02<00:01,  4.36it/s][A
 75%|███████▌  | 12/16 [00:02<00:00,  4.35it/s][A
 81%|████████▏ | 13/16 [00:02<00:00,  4.33it/s][A
 88%|████████▊ | 14/16 [00:03<00:00,  4.32it/s][A
 94%|█████████▍| 15/16 [00:03<00:00,  4.32it/s][A
100%|██████████| 16/16 [00:03<00:00,  4.89it/s][A                                                 
                                               [A 40%|████      | 128/320 [05:12<02:59,  1.07it/s]
100%|██████████| 16/16 [00:03<00:00,  4.89it/s][A
                                               [ASaving model checkpoint to results/checkpoint-128
Configuration saved in results/checkpoint-128/config.json
Model weights saved in results/checkpoint-128/pytorch_model.bin
 40%|████      | 129/320 [07:59<2:45:28, 51.98s/it] 41%|████      | 130/320 [08:00<1:56:16, 36.72s/it] 41%|████      | 131/320 [08:01<1:22:00, 26.03s/it] 41%|████▏     | 132/320 [08:02<58:08, 18.55s/it]   42%|████▏     | 133/320 [08:03<41:30, 13.32s/it] 42%|████▏     | 134/320 [08:05<29:55,  9.66s/it] 42%|████▏     | 135/320 [08:06<21:51,  7.09s/it] 42%|████▎     | 136/320 [08:07<16:13,  5.29s/it] 43%|████▎     | 137/320 [08:08<12:18,  4.04s/it] 43%|████▎     | 138/320 [08:09<09:34,  3.16s/it] 43%|████▎     | 139/320 [08:10<07:39,  2.54s/it] 44%|████▍     | 140/320 [08:11<06:19,  2.11s/it] 44%|████▍     | 141/320 [08:12<05:23,  1.81s/it] 44%|████▍     | 142/320 [08:13<04:44,  1.60s/it] 45%|████▍     | 143/320 [08:14<04:16,  1.45s/it] 45%|████▌     | 144/320 [08:16<03:56,  1.34s/it] 45%|████▌     | 145/320 [08:17<03:42,  1.27s/it] 46%|████▌     | 146/320 [08:18<03:32,  1.22s/it] 46%|████▌     | 147/320 [08:19<03:25,  1.19s/it] 46%|████▋     | 148/320 [08:20<03:19,  1.16s/it] 47%|████▋     | 149/320 [08:21<03:15,  1.14s/it] 47%|████▋     | 150/320 [08:22<03:12,  1.13s/it] 47%|████▋     | 151/320 [08:23<03:09,  1.12s/it] 48%|████▊     | 152/320 [08:24<03:07,  1.12s/it] 48%|████▊     | 153/320 [08:25<03:05,  1.11s/it] 48%|████▊     | 154/320 [08:27<03:04,  1.11s/it] 48%|████▊     | 155/320 [08:28<03:03,  1.11s/it] 49%|████▉     | 156/320 [08:29<03:01,  1.11s/it] 49%|████▉     | 157/320 [08:30<03:00,  1.11s/it] 49%|████▉     | 158/320 [08:31<02:58,  1.10s/it] 50%|████▉     | 159/320 [08:32<02:57,  1.10s/it] 50%|█████     | 160/320 [08:33<02:56,  1.11s/it] 50%|█████     | 161/320 [08:34<02:55,  1.11s/it] 51%|█████     | 162/320 [08:35<02:54,  1.10s/it] 51%|█████     | 163/320 [08:36<02:53,  1.10s/it] 51%|█████▏    | 164/320 [08:38<02:52,  1.10s/it] 52%|█████▏    | 165/320 [08:39<02:51,  1.11s/it] 52%|█████▏    | 166/320 [08:40<02:50,  1.11s/it] 52%|█████▏    | 167/320 [08:41<02:48,  1.10s/it] 52%|█████▎    | 168/320 [08:42<02:47,  1.10s/it] 53%|█████▎    | 169/320 [08:43<02:46,  1.10s/it] 53%|█████▎    | 170/320 [08:44<02:45,  1.11s/it] 53%|█████▎    | 171/320 [08:45<02:44,  1.11s/it] 54%|█████▍    | 172/320 [08:46<02:43,  1.11s/it] 54%|█████▍    | 173/320 [08:48<02:42,  1.10s/it] 54%|█████▍    | 174/320 [08:49<02:41,  1.10s/it] 55%|█████▍    | 175/320 [08:50<02:40,  1.10s/it] 55%|█████▌    | 176/320 [08:51<02:38,  1.10s/it] 55%|█████▌    | 177/320 [08:52<02:37,  1.10s/it] 56%|█████▌    | 178/320 [08:53<02:36,  1.10s/it] 56%|█████▌    | 179/320 [08:54<02:35,  1.10s/it] 56%|█████▋    | 180/320 [08:55<02:34,  1.10s/it] 57%|█████▋    | 181/320 [08:56<02:33,  1.10s/it] 57%|█████▋    | 182/320 [08:57<02:32,  1.10s/it] 57%|█████▋    | 183/320 [08:59<02:31,  1.10s/it] 57%|█████▊    | 184/320 [09:00<02:30,  1.10s/it] 58%|█████▊    | 185/320 [09:01<02:28,  1.10s/it] 58%|█████▊    | 186/320 [09:02<02:27,  1.10s/it] 58%|█████▊    | 187/320 [09:03<02:26,  1.10s/it] 59%|█████▉    | 188/320 [09:04<02:25,  1.10s/it] 59%|█████▉    | 189/320 [09:05<02:24,  1.10s/it] 59%|█████▉    | 190/320 [09:06<02:23,  1.10s/it] 60%|█████▉    | 191/320 [09:07<02:22,  1.10s/it] 60%|██████    | 192/320 [09:08<01:59,  1.07it/s]***** Running Evaluation *****
  Num examples = 496
  Batch size = 32
{'eval_loss': 1.0625700950622559, 'eval_runtime': 3.6243, 'eval_samples_per_second': 136.855, 'eval_steps_per_second': 4.415, 'epoch': 2.0}

  0%|          | 0/16 [00:00<?, ?it/s][A
 12%|█▎        | 2/16 [00:00<00:01,  8.63it/s][A
 19%|█▉        | 3/16 [00:00<00:02,  6.08it/s][A
 25%|██▌       | 4/16 [00:00<00:02,  5.27it/s][A
 31%|███▏      | 5/16 [00:00<00:02,  4.89it/s][A
 38%|███▊      | 6/16 [00:01<00:02,  4.68it/s][A
 44%|████▍     | 7/16 [00:01<00:01,  4.55it/s][A
 50%|█████     | 8/16 [00:01<00:01,  4.47it/s][A
 56%|█████▋    | 9/16 [00:01<00:01,  4.42it/s][A
 62%|██████▎   | 10/16 [00:02<00:01,  4.38it/s][A
 69%|██████▉   | 11/16 [00:02<00:01,  4.36it/s][A
 75%|███████▌  | 12/16 [00:02<00:00,  4.34it/s][A
 81%|████████▏ | 13/16 [00:02<00:00,  4.33it/s][A
 88%|████████▊ | 14/16 [00:03<00:00,  4.32it/s][A
 94%|█████████▍| 15/16 [00:03<00:00,  4.32it/s][A
100%|██████████| 16/16 [00:03<00:00,  4.89it/s][A                                                 
                                               [A 60%|██████    | 192/320 [09:12<01:59,  1.07it/s]
100%|██████████| 16/16 [00:03<00:00,  4.89it/s][A
                                               [ASaving model checkpoint to results/checkpoint-192
Configuration saved in results/checkpoint-192/config.json
Model weights saved in results/checkpoint-192/pytorch_model.bin
 60%|██████    | 193/320 [11:39<1:37:26, 46.04s/it] 61%|██████    | 194/320 [11:40<1:08:21, 32.55s/it] 61%|██████    | 195/320 [11:41<48:09, 23.12s/it]   61%|██████▏   | 196/320 [11:43<34:07, 16.52s/it] 62%|██████▏   | 197/320 [11:44<24:22, 11.89s/it] 62%|██████▏   | 198/320 [11:45<17:35,  8.66s/it] 62%|██████▏   | 199/320 [11:46<12:53,  6.39s/it] 62%|██████▎   | 200/320 [11:47<09:36,  4.80s/it] 63%|██████▎   | 201/320 [11:48<07:19,  3.69s/it] 63%|██████▎   | 202/320 [11:49<05:44,  2.92s/it] 63%|██████▎   | 203/320 [11:50<04:37,  2.37s/it] 64%|██████▍   | 204/320 [11:51<03:51,  1.99s/it] 64%|██████▍   | 205/320 [11:52<03:18,  1.73s/it] 64%|██████▍   | 206/320 [11:54<02:55,  1.54s/it] 65%|██████▍   | 207/320 [11:55<02:39,  1.41s/it] 65%|██████▌   | 208/320 [11:56<02:27,  1.32s/it] 65%|██████▌   | 209/320 [11:57<02:19,  1.25s/it] 66%|██████▌   | 210/320 [11:58<02:12,  1.21s/it] 66%|██████▌   | 211/320 [11:59<02:08,  1.18s/it] 66%|██████▋   | 212/320 [12:00<02:04,  1.16s/it] 67%|██████▋   | 213/320 [12:01<02:01,  1.14s/it] 67%|██████▋   | 214/320 [12:02<01:59,  1.13s/it] 67%|██████▋   | 215/320 [12:03<01:57,  1.12s/it] 68%|██████▊   | 216/320 [12:05<01:56,  1.12s/it] 68%|██████▊   | 217/320 [12:06<01:54,  1.11s/it] 68%|██████▊   | 218/320 [12:07<01:53,  1.11s/it] 68%|██████▊   | 219/320 [12:08<01:51,  1.11s/it] 69%|██████▉   | 220/320 [12:09<01:50,  1.11s/it] 69%|██████▉   | 221/320 [12:10<01:49,  1.11s/it] 69%|██████▉   | 222/320 [12:11<01:48,  1.10s/it] 70%|██████▉   | 223/320 [12:12<01:47,  1.10s/it] 70%|███████   | 224/320 [12:13<01:45,  1.10s/it] 70%|███████   | 225/320 [12:15<01:44,  1.10s/it] 71%|███████   | 226/320 [12:16<01:43,  1.10s/it] 71%|███████   | 227/320 [12:17<01:42,  1.10s/it] 71%|███████▏  | 228/320 [12:18<01:41,  1.10s/it] 72%|███████▏  | 229/320 [12:19<01:40,  1.10s/it] 72%|███████▏  | 230/320 [12:20<01:39,  1.10s/it] 72%|███████▏  | 231/320 [12:21<01:38,  1.10s/it] 72%|███████▎  | 232/320 [12:22<01:37,  1.10s/it] 73%|███████▎  | 233/320 [12:23<01:35,  1.10s/it] 73%|███████▎  | 234/320 [12:24<01:34,  1.10s/it] 73%|███████▎  | 235/320 [12:26<01:33,  1.10s/it] 74%|███████▍  | 236/320 [12:27<01:32,  1.10s/it] 74%|███████▍  | 237/320 [12:28<01:31,  1.10s/it] 74%|███████▍  | 238/320 [12:29<01:30,  1.10s/it] 75%|███████▍  | 239/320 [12:30<01:29,  1.11s/it] 75%|███████▌  | 240/320 [12:31<01:28,  1.11s/it] 75%|███████▌  | 241/320 [12:32<01:27,  1.10s/it] 76%|███████▌  | 242/320 [12:33<01:26,  1.10s/it] 76%|███████▌  | 243/320 [12:34<01:24,  1.10s/it] 76%|███████▋  | 244/320 [12:36<01:23,  1.10s/it] 77%|███████▋  | 245/320 [12:37<01:22,  1.10s/it] 77%|███████▋  | 246/320 [12:38<01:21,  1.10s/it] 77%|███████▋  | 247/320 [12:39<01:20,  1.10s/it] 78%|███████▊  | 248/320 [12:40<01:19,  1.10s/it] 78%|███████▊  | 249/320 [12:41<01:18,  1.11s/it] 78%|███████▊  | 250/320 [12:42<01:17,  1.11s/it] 78%|███████▊  | 251/320 [12:43<01:16,  1.11s/it] 79%|███████▉  | 252/320 [12:44<01:15,  1.10s/it] 79%|███████▉  | 253/320 [12:45<01:13,  1.10s/it] 79%|███████▉  | 254/320 [12:47<01:12,  1.10s/it] 80%|███████▉  | 255/320 [12:48<01:11,  1.11s/it] 80%|████████  | 256/320 [12:48<00:59,  1.07it/s]***** Running Evaluation *****
  Num examples = 496
  Batch size = 32
{'eval_loss': 1.1493303775787354, 'eval_runtime': 3.6255, 'eval_samples_per_second': 136.81, 'eval_steps_per_second': 4.413, 'epoch': 3.0}

  0%|          | 0/16 [00:00<?, ?it/s][A
 12%|█▎        | 2/16 [00:00<00:01,  8.63it/s][A
 19%|█▉        | 3/16 [00:00<00:02,  6.08it/s][A
 25%|██▌       | 4/16 [00:00<00:02,  5.27it/s][A
 31%|███▏      | 5/16 [00:00<00:02,  4.89it/s][A
 38%|███▊      | 6/16 [00:01<00:02,  4.68it/s][A
 44%|████▍     | 7/16 [00:01<00:01,  4.55it/s][A
 50%|█████     | 8/16 [00:01<00:01,  4.47it/s][A
 56%|█████▋    | 9/16 [00:01<00:01,  4.42it/s][A
 62%|██████▎   | 10/16 [00:02<00:01,  4.38it/s][A
 69%|██████▉   | 11/16 [00:02<00:01,  4.36it/s][A
 75%|███████▌  | 12/16 [00:02<00:00,  4.34it/s][A
 81%|████████▏ | 13/16 [00:02<00:00,  4.33it/s][A
 88%|████████▊ | 14/16 [00:03<00:00,  4.32it/s][A
 94%|█████████▍| 15/16 [00:03<00:00,  4.31it/s][A
100%|██████████| 16/16 [00:03<00:00,  4.89it/s][A                                                 
                                               [A 80%|████████  | 256/320 [12:52<00:59,  1.07it/s]
100%|██████████| 16/16 [00:03<00:00,  4.89it/s][A
                                               [ASaving model checkpoint to results/checkpoint-256
Configuration saved in results/checkpoint-256/config.json
Model weights saved in results/checkpoint-256/pytorch_model.bin
 80%|████████  | 257/320 [14:22<30:12, 28.76s/it] 81%|████████  | 258/320 [14:23<21:08, 20.47s/it] 81%|████████  | 259/320 [14:24<14:54, 14.66s/it] 81%|████████▏ | 260/320 [14:25<10:35, 10.59s/it] 82%|████████▏ | 261/320 [14:26<07:37,  7.75s/it] 82%|████████▏ | 262/320 [14:27<05:33,  5.75s/it] 82%|████████▏ | 263/320 [14:29<04:08,  4.36s/it] 82%|████████▎ | 264/320 [14:30<03:09,  3.38s/it] 83%|████████▎ | 265/320 [14:31<02:28,  2.70s/it] 83%|████████▎ | 266/320 [14:32<01:59,  2.22s/it] 83%|████████▎ | 267/320 [14:33<01:39,  1.89s/it] 84%|████████▍ | 268/320 [14:34<01:25,  1.65s/it] 84%|████████▍ | 269/320 [14:35<01:15,  1.49s/it] 84%|████████▍ | 270/320 [14:36<01:08,  1.37s/it] 85%|████████▍ | 271/320 [14:37<01:03,  1.29s/it] 85%|████████▌ | 272/320 [14:38<00:59,  1.23s/it] 85%|████████▌ | 273/320 [14:40<00:56,  1.19s/it] 86%|████████▌ | 274/320 [14:41<00:53,  1.17s/it] 86%|████████▌ | 275/320 [14:42<00:51,  1.15s/it] 86%|████████▋ | 276/320 [14:43<00:49,  1.13s/it] 87%|████████▋ | 277/320 [14:44<00:48,  1.13s/it] 87%|████████▋ | 278/320 [14:45<00:47,  1.12s/it] 87%|████████▋ | 279/320 [14:46<00:45,  1.12s/it] 88%|████████▊ | 280/320 [14:47<00:44,  1.11s/it] 88%|████████▊ | 281/320 [14:48<00:43,  1.11s/it] 88%|████████▊ | 282/320 [14:49<00:42,  1.11s/it] 88%|████████▊ | 283/320 [14:51<00:40,  1.11s/it] 89%|████████▉ | 284/320 [14:52<00:39,  1.11s/it] 89%|████████▉ | 285/320 [14:53<00:38,  1.11s/it] 89%|████████▉ | 286/320 [14:54<00:37,  1.10s/it] 90%|████████▉ | 287/320 [14:55<00:36,  1.10s/it] 90%|█████████ | 288/320 [14:56<00:35,  1.10s/it] 90%|█████████ | 289/320 [14:57<00:34,  1.11s/it] 91%|█████████ | 290/320 [14:58<00:33,  1.11s/it] 91%|█████████ | 291/320 [14:59<00:32,  1.11s/it] 91%|█████████▏| 292/320 [15:01<00:30,  1.11s/it] 92%|█████████▏| 293/320 [15:02<00:29,  1.10s/it] 92%|█████████▏| 294/320 [15:03<00:28,  1.10s/it] 92%|█████████▏| 295/320 [15:04<00:27,  1.10s/it] 92%|█████████▎| 296/320 [15:05<00:26,  1.10s/it] 93%|█████████▎| 297/320 [15:06<00:25,  1.10s/it] 93%|█████████▎| 298/320 [15:07<00:24,  1.10s/it] 93%|█████████▎| 299/320 [15:08<00:23,  1.10s/it] 94%|█████████▍| 300/320 [15:09<00:22,  1.10s/it] 94%|█████████▍| 301/320 [15:10<00:20,  1.10s/it] 94%|█████████▍| 302/320 [15:12<00:19,  1.10s/it] 95%|█████████▍| 303/320 [15:13<00:18,  1.10s/it] 95%|█████████▌| 304/320 [15:14<00:17,  1.10s/it] 95%|█████████▌| 305/320 [15:15<00:16,  1.10s/it] 96%|█████████▌| 306/320 [15:16<00:15,  1.10s/it] 96%|█████████▌| 307/320 [15:17<00:14,  1.10s/it] 96%|█████████▋| 308/320 [15:18<00:13,  1.10s/it] 97%|█████████▋| 309/320 [15:19<00:12,  1.10s/it] 97%|█████████▋| 310/320 [15:20<00:11,  1.10s/it] 97%|█████████▋| 311/320 [15:22<00:09,  1.10s/it] 98%|█████████▊| 312/320 [15:23<00:08,  1.10s/it] 98%|█████████▊| 313/320 [15:24<00:07,  1.10s/it] 98%|█████████▊| 314/320 [15:25<00:06,  1.11s/it] 98%|█████████▊| 315/320 [15:26<00:05,  1.11s/it] 99%|█████████▉| 316/320 [15:27<00:04,  1.11s/it] 99%|█████████▉| 317/320 [15:28<00:03,  1.11s/it] 99%|█████████▉| 318/320 [15:29<00:02,  1.11s/it]100%|█████████▉| 319/320 [15:30<00:01,  1.11s/it]100%|██████████| 320/320 [15:31<00:00,  1.07it/s]***** Running Evaluation *****
  Num examples = 496
  Batch size = 32
{'eval_loss': 1.241378664970398, 'eval_runtime': 3.6277, 'eval_samples_per_second': 136.725, 'eval_steps_per_second': 4.41, 'epoch': 4.0}

  0%|          | 0/16 [00:00<?, ?it/s][A
 12%|█▎        | 2/16 [00:00<00:01,  8.62it/s][A
 19%|█▉        | 3/16 [00:00<00:02,  6.08it/s][A
 25%|██▌       | 4/16 [00:00<00:02,  5.27it/s][A
 31%|███▏      | 5/16 [00:00<00:02,  4.89it/s][A
 38%|███▊      | 6/16 [00:01<00:02,  4.67it/s][A
 44%|████▍     | 7/16 [00:01<00:01,  4.55it/s][A
 50%|█████     | 8/16 [00:01<00:01,  4.47it/s][A
 56%|█████▋    | 9/16 [00:01<00:01,  4.41it/s][A
 62%|██████▎   | 10/16 [00:02<00:01,  4.38it/s][A
 69%|██████▉   | 11/16 [00:02<00:01,  4.36it/s][A
 75%|███████▌  | 12/16 [00:02<00:00,  4.34it/s][A
 81%|████████▏ | 13/16 [00:02<00:00,  4.33it/s][A
 88%|████████▊ | 14/16 [00:03<00:00,  4.32it/s][A
 94%|█████████▍| 15/16 [00:03<00:00,  4.32it/s][A
100%|██████████| 16/16 [00:03<00:00,  4.89it/s][A                                                 
                                               [A100%|██████████| 320/320 [15:35<00:00,  1.07it/s]
100%|██████████| 16/16 [00:03<00:00,  4.89it/s][A
                                               [ASaving model checkpoint to results/checkpoint-320
Configuration saved in results/checkpoint-320/config.json
Model weights saved in results/checkpoint-320/pytorch_model.bin


Training completed. Do not forget to share your model on huggingface.co/models =)


Loading best model from results/checkpoint-64 (score: 1.0494050979614258).
                                                 100%|██████████| 320/320 [18:00<00:00,  1.07it/s]100%|██████████| 320/320 [18:00<00:00,  3.38s/it]
***** Running Evaluation *****
  Num examples = 496
  Batch size = 32
{'eval_loss': 1.3016856908798218, 'eval_runtime': 3.6288, 'eval_samples_per_second': 136.683, 'eval_steps_per_second': 4.409, 'epoch': 5.0}
{'train_runtime': 1080.2186, 'train_samples_per_second': 9.35, 'train_steps_per_second': 0.296, 'train_loss': 0.727689552307129, 'epoch': 5.0}
  0%|          | 0/16 [00:00<?, ?it/s] 12%|█▎        | 2/16 [00:00<00:01,  8.59it/s] 19%|█▉        | 3/16 [00:00<00:02,  6.05it/s] 25%|██▌       | 4/16 [00:00<00:02,  5.25it/s] 31%|███▏      | 5/16 [00:00<00:02,  4.87it/s] 38%|███▊      | 6/16 [00:01<00:02,  4.66it/s] 44%|████▍     | 7/16 [00:01<00:01,  4.53it/s] 50%|█████     | 8/16 [00:01<00:01,  4.45it/s] 56%|█████▋    | 9/16 [00:01<00:01,  4.40it/s] 62%|██████▎   | 10/16 [00:02<00:01,  4.36it/s] 69%|██████▉   | 11/16 [00:02<00:01,  4.34it/s] 75%|███████▌  | 12/16 [00:02<00:00,  4.32it/s] 81%|████████▏ | 13/16 [00:02<00:00,  4.31it/s] 88%|████████▊ | 14/16 [00:03<00:00,  4.30it/s] 94%|█████████▍| 15/16 [00:03<00:00,  4.30it/s]100%|██████████| 16/16 [00:03<00:00,  4.85it/s]100%|██████████| 16/16 [00:03<00:00,  4.68it/s]
Saving model checkpoint to results/best-checkpoints/20q/gpt2-large/inversed
Configuration saved in results/best-checkpoints/20q/gpt2-large/inversed/config.json
Model weights saved in results/best-checkpoints/20q/gpt2-large/inversed/pytorch_model.bin
{'eval_loss': 1.0494050979614258, 'eval_runtime': 3.6384, 'eval_samples_per_second': 136.323, 'eval_steps_per_second': 4.398, 'epoch': 5.0}
Loaded dataset with 2020 elements
Loaded dataset with 496 elements
Loaded dataset with 2520 elements
train Accuracy =  0.948019801980198
train F1 score =  0.9571394589776943
train Confusion Matrix =  [[ 893   64]
 [   0 1022]]
Classification Report               precision    recall  f1-score   support

        6407       1.00      0.90      0.95       994
       10352       0.94      1.00      0.97      1026

   micro avg       0.97      0.95      0.96      2020
   macro avg       0.97      0.95      0.96      2020
weighted avg       0.97      0.95      0.96      2020

valid Accuracy =  0.9596774193548387
valid F1 score =  0.9662214591140974
valid Confusion Matrix =  [[228  13]
 [  0 248]]
Classification Report               precision    recall  f1-score   support

        6407       1.00      0.92      0.96       248
       10352       0.95      1.00      0.97       248

   micro avg       0.97      0.96      0.97       496
   macro avg       0.98      0.96      0.97       496
weighted avg       0.98      0.96      0.97       496

test Accuracy =  0.946031746031746
test F1 score =  0.9533479678537509
test Confusion Matrix =  [[1110   94]
 [   0 1274]]
Classification Report               precision    recall  f1-score   support

        6407       1.00      0.89      0.94      1246
       10352       0.93      1.00      0.96      1274

   micro avg       0.96      0.95      0.95      2520
   macro avg       0.97      0.95      0.95      2520
weighted avg       0.97      0.95      0.95      2520

