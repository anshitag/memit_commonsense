Loading miniconda version 22.11.1-1
/home/asheshadri_umass_edu/.conda/envs/memit/lib/python3.9/site-packages/transformers/optimization.py:306: FutureWarning: This implementation of AdamW is deprecated and will be removed in a future version. Use the PyTorch implementation torch.optim.AdamW instead, or set `no_deprecation_warning=True` to disable this warning
  warnings.warn(
***** Running training *****
  Num examples = 1227
  Num Epochs = 2
  Instantaneous batch size per device = 64
  Total train batch size (w. parallel, distributed & accumulation) = 64
  Gradient Accumulation steps = 1
  Total optimization steps = 40
Loaded dataset with 1227 elements
Loaded dataset with 304 elements
  0%|          | 0/40 [00:00<?, ?it/s]  2%|â–Ž         | 1/40 [00:06<04:13,  6.49s/it]  5%|â–Œ         | 2/40 [00:06<01:49,  2.87s/it]  8%|â–Š         | 3/40 [00:07<01:03,  1.71s/it] 10%|â–ˆ         | 4/40 [00:07<00:41,  1.16s/it] 12%|â–ˆâ–Ž        | 5/40 [00:07<00:30,  1.16it/s] 15%|â–ˆâ–Œ        | 6/40 [00:08<00:23,  1.48it/s] 18%|â–ˆâ–Š        | 7/40 [00:08<00:18,  1.78it/s] 20%|â–ˆâ–ˆ        | 8/40 [00:08<00:15,  2.06it/s] 22%|â–ˆâ–ˆâ–Ž       | 9/40 [00:09<00:13,  2.29it/s] 25%|â–ˆâ–ˆâ–Œ       | 10/40 [00:09<00:12,  2.49it/s] 28%|â–ˆâ–ˆâ–Š       | 11/40 [00:09<00:10,  2.65it/s] 30%|â–ˆâ–ˆâ–ˆ       | 12/40 [00:10<00:10,  2.76it/s] 32%|â–ˆâ–ˆâ–ˆâ–Ž      | 13/40 [00:10<00:09,  2.85it/s] 35%|â–ˆâ–ˆâ–ˆâ–Œ      | 14/40 [00:10<00:08,  2.92it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 15/40 [00:11<00:08,  2.96it/s] 40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 16/40 [00:11<00:08,  2.99it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 17/40 [00:11<00:07,  3.01it/s] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 18/40 [00:12<00:07,  3.03it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 19/40 [00:12<00:06,  3.03it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 20/40 [00:12<00:05,  3.49it/s]***** Running Evaluation *****
  Num examples = 304
  Batch size = 64

  0%|          | 0/5 [00:00<?, ?it/s][A
 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 3/5 [00:00<00:00, 18.27it/s][A
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [00:00<00:00, 15.18it/s][A                                               
                                             [A 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 20/40 [00:12<00:05,  3.49it/s]
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [00:00<00:00, 15.18it/s][A
                                             [ASaving model checkpoint to result/checkpoints/pep3k/gpt2-medium/inversed/checkpoint-20
Configuration saved in result/checkpoints/pep3k/gpt2-medium/inversed/checkpoint-20/config.json
Model weights saved in result/checkpoints/pep3k/gpt2-medium/inversed/checkpoint-20/pytorch_model.bin
 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 21/40 [00:54<04:04, 12.86s/it] 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 22/40 [00:55<02:43,  9.10s/it] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 23/40 [00:55<01:49,  6.47s/it] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 24/40 [00:55<01:14,  4.63s/it] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 25/40 [00:56<00:50,  3.34s/it] 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 26/40 [00:56<00:34,  2.43s/it] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 27/40 [00:56<00:23,  1.80s/it] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 28/40 [00:57<00:16,  1.36s/it] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 29/40 [00:57<00:11,  1.05s/it] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 30/40 [00:57<00:08,  1.20it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 31/40 [00:57<00:06,  1.47it/s] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 32/40 [00:58<00:04,  1.75it/s] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 33/40 [00:58<00:03,  2.00it/s] 85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 34/40 [00:58<00:02,  2.23it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 35/40 [00:59<00:02,  2.43it/s] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 36/40 [00:59<00:01,  2.59it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 37/40 [00:59<00:01,  2.72it/s] 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 38/40 [01:00<00:00,  2.81it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 39/40 [01:00<00:00,  2.87it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 40/40 [01:00<00:00,  3.45it/s]***** Running Evaluation *****
  Num examples = 304
  Batch size = 64
{'eval_loss': 1.1967638731002808, 'eval_runtime': 0.4081, 'eval_samples_per_second': 745.001, 'eval_steps_per_second': 12.253, 'epoch': 1.0}

  0%|          | 0/5 [00:00<?, ?it/s][A
 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 3/5 [00:00<00:00, 17.54it/s][A
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [00:00<00:00, 14.85it/s][A                                               
                                             [A100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 40/40 [01:01<00:00,  3.45it/s]
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [00:00<00:00, 14.85it/s][A
                                             [ASaving model checkpoint to result/checkpoints/pep3k/gpt2-medium/inversed/checkpoint-40
Configuration saved in result/checkpoints/pep3k/gpt2-medium/inversed/checkpoint-40/config.json
Model weights saved in result/checkpoints/pep3k/gpt2-medium/inversed/checkpoint-40/pytorch_model.bin


Training completed. Do not forget to share your model on huggingface.co/models =)


Loading best model from result/checkpoints/pep3k/gpt2-medium/inversed/checkpoint-40 (score: 1.1139543056488037).
                                               100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 40/40 [02:01<00:00,  3.45it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 40/40 [02:01<00:00,  3.04s/it]
***** Running Evaluation *****
  Num examples = 304
  Batch size = 64
{'eval_loss': 1.1139543056488037, 'eval_runtime': 0.4085, 'eval_samples_per_second': 744.233, 'eval_steps_per_second': 12.241, 'epoch': 2.0}
{'train_runtime': 121.4241, 'train_samples_per_second': 20.21, 'train_steps_per_second': 0.329, 'train_loss': 1.8178226470947265, 'epoch': 2.0}
  0%|          | 0/5 [00:00<?, ?it/s] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 3/5 [00:00<00:00, 16.84it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [00:00<00:00, 14.47it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [00:00<00:00, 14.49it/s]
Saving model checkpoint to result/best-checkpoints/pep3k/gpt2-medium/inversed
Configuration saved in result/best-checkpoints/pep3k/gpt2-medium/inversed/config.json
Model weights saved in result/best-checkpoints/pep3k/gpt2-medium/inversed/pytorch_model.bin
loading configuration file result/best-checkpoints/pep3k/gpt2-medium/inversed/config.json
Model config GPT2Config {
  "_name_or_path": "result/best-checkpoints/pep3k/gpt2-medium/inversed",
  "activation_function": "gelu_new",
  "architectures": [
    "GPT2LMHeadModel"
  ],
  "attn_pdrop": 0.1,
  "bos_token_id": 50256,
  "embd_pdrop": 0.1,
  "eos_token_id": 50256,
  "initializer_range": 0.02,
  "layer_norm_epsilon": 1e-05,
  "model_type": "gpt2",
  "n_ctx": 1024,
  "n_embd": 1024,
  "n_head": 16,
  "n_inner": null,
  "n_layer": 24,
  "n_positions": 1024,
  "n_special": 0,
  "predict_special_tokens": true,
  "reorder_and_upcast_attn": false,
  "resid_pdrop": 0.1,
  "scale_attn_by_inverse_layer_idx": false,
  "scale_attn_weights": true,
  "summary_activation": null,
  "summary_first_dropout": 0.1,
  "summary_proj_to_labels": true,
  "summary_type": "cls_index",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 50
    }
  },
  "torch_dtype": "float32",
  "transformers_version": "4.23.1",
  "use_cache": true,
  "vocab_size": 50257
}

loading weights file result/best-checkpoints/pep3k/gpt2-medium/inversed/pytorch_model.bin
All model checkpoint weights were used when initializing GPT2LMHeadModel.

All the weights of GPT2LMHeadModel were initialized from the model checkpoint at result/best-checkpoints/pep3k/gpt2-medium/inversed.
If your task is similar to the task the model of the checkpoint was trained on, you can already use GPT2LMHeadModel for predictions without further training.
Could not locate the tokenizer configuration file, will try to use the model config instead.
loading configuration file config.json from cache at /work/pi_adrozdov_umass_edu/akshay_umass_edu/hf_cache/hub/models--gpt2-medium/snapshots/425b0cc90498ac177aa51ba07be26fc2fea6af9d/config.json
Model config GPT2Config {
  "_name_or_path": "gpt2-medium",
  "activation_function": "gelu_new",
  "architectures": [
    "GPT2LMHeadModel"
  ],
  "attn_pdrop": 0.1,
  "bos_token_id": 50256,
  "embd_pdrop": 0.1,
  "eos_token_id": 50256,
  "initializer_range": 0.02,
  "layer_norm_epsilon": 1e-05,
  "model_type": "gpt2",
  "n_ctx": 1024,
  "n_embd": 1024,
  "n_head": 16,
  "n_inner": null,
  "n_layer": 24,
  "n_positions": 1024,
  "n_special": 0,
  "predict_special_tokens": true,
  "reorder_and_upcast_attn": false,
  "resid_pdrop": 0.1,
  "scale_attn_by_inverse_layer_idx": false,
  "scale_attn_weights": true,
  "summary_activation": null,
  "summary_first_dropout": 0.1,
  "summary_proj_to_labels": true,
  "summary_type": "cls_index",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 50
    }
  },
  "transformers_version": "4.23.1",
  "use_cache": true,
  "vocab_size": 50257
}

loading file vocab.json from cache at /work/pi_adrozdov_umass_edu/akshay_umass_edu/hf_cache/hub/models--gpt2-medium/snapshots/425b0cc90498ac177aa51ba07be26fc2fea6af9d/vocab.json
loading file merges.txt from cache at /work/pi_adrozdov_umass_edu/akshay_umass_edu/hf_cache/hub/models--gpt2-medium/snapshots/425b0cc90498ac177aa51ba07be26fc2fea6af9d/merges.txt
loading file tokenizer.json from cache at /work/pi_adrozdov_umass_edu/akshay_umass_edu/hf_cache/hub/models--gpt2-medium/snapshots/425b0cc90498ac177aa51ba07be26fc2fea6af9d/tokenizer.json
loading file added_tokens.json from cache at None
loading file special_tokens_map.json from cache at None
loading file tokenizer_config.json from cache at None
loading configuration file config.json from cache at /work/pi_adrozdov_umass_edu/akshay_umass_edu/hf_cache/hub/models--gpt2-medium/snapshots/425b0cc90498ac177aa51ba07be26fc2fea6af9d/config.json
Model config GPT2Config {
  "_name_or_path": "gpt2-medium",
  "activation_function": "gelu_new",
  "architectures": [
    "GPT2LMHeadModel"
  ],
  "attn_pdrop": 0.1,
  "bos_token_id": 50256,
  "embd_pdrop": 0.1,
  "eos_token_id": 50256,
  "initializer_range": 0.02,
  "layer_norm_epsilon": 1e-05,
  "model_type": "gpt2",
  "n_ctx": 1024,
  "n_embd": 1024,
  "n_head": 16,
  "n_inner": null,
  "n_layer": 24,
  "n_positions": 1024,
  "n_special": 0,
  "predict_special_tokens": true,
  "reorder_and_upcast_attn": false,
  "resid_pdrop": 0.1,
  "scale_attn_by_inverse_layer_idx": false,
  "scale_attn_weights": true,
  "summary_activation": null,
  "summary_first_dropout": 0.1,
  "summary_proj_to_labels": true,
  "summary_type": "cls_index",
  "summary_use_proj": true,
  "task_specific_params": {
    "text-generation": {
      "do_sample": true,
      "max_length": 50
    }
  },
  "transformers_version": "4.23.1",
  "use_cache": true,
  "vocab_size": 50257
}

{'eval_loss': 1.1139543056488037, 'eval_runtime': 0.4311, 'eval_samples_per_second': 705.12, 'eval_steps_per_second': 11.597, 'epoch': 2.0}
Loaded dataset with 1227 elements
Loaded dataset with 304 elements
Loaded dataset with 1531 elements
train Accuracy =  0.6715566422167889
train F1 score =  0.7810232166379151
train Confusion Matrix = 
 [[407 203   0]
 [200 417   0]
 [  0   0   0]]
Classification Report: 
               precision    recall  f1-score   support

        True       0.67      0.67      0.67       610
       False       0.67      0.68      0.67       617
        None       1.00      1.00      1.00         0

   micro avg       0.67      0.67      0.67      1227
   macro avg       0.78      0.78      0.78      1227
weighted avg       0.67      0.67      0.67      1227

valid Accuracy =  0.5625
valid F1 score =  0.6977058029689608
valid Confusion Matrix = 
 [[ 57  95   0]
 [ 38 114   0]
 [  0   0   0]]
Classification Report: 
               precision    recall  f1-score   support

        True       0.60      0.38      0.46       152
       False       0.55      0.75      0.63       152
        None       1.00      1.00      1.00         0

   micro avg       0.56      0.56      0.56       304
   macro avg       0.72      0.71      0.70       304
weighted avg       0.57      0.56      0.55       304

test Accuracy =  0.5558458523840627
test F1 score =  0.7021578024654062
test Confusion Matrix = 
 [[367 405   0]
 [275 484   0]
 [  0   0   0]]
Classification Report: 
               precision    recall  f1-score   support

        True       0.57      0.48      0.52       772
       False       0.54      0.64      0.59       759
        None       1.00      1.00      1.00         0

   micro avg       0.56      0.56      0.56      1531
   macro avg       0.71      0.70      0.70      1531
weighted avg       0.56      0.56      0.55      1531

